(function(s,t){typeof exports=="object"&&typeof module!="undefined"?t(exports):typeof define=="function"&&define.amd?define(["exports"],t):(s=typeof globalThis!="undefined"?globalThis:s||self,t(s.Springify={}))})(this,function(s){"use strict";var p=Object.defineProperty;var r=(s,t,n)=>t in s?p(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n;var i=(s,t,n)=>(r(s,typeof t!="symbol"?t+"":t,n),n);const t=(u,e,a)=>u*(a-e)/100+e;class n{constructor({stiffness:e=10,damping:a=30,mass:h=20,input:o=0,onFrame:m=()=>null,onFinished:l=()=>{}}){i(this,"_input");i(this,"output");i(this,"stiffness");i(this,"damping");i(this,"mass");i(this,"velocity",0);i(this,"amplitude",0);i(this,"animating");i(this,"callback");i(this,"lastTime");i(this,"currentTime");i(this,"delta");i(this,"animationFrame");i(this,"onFinished");i(this,"interpolate",()=>{const e=t(this.stiffness,-1,-300),a=t(this.damping,-.4,-20),h=t(this.mass,.1,10),o=e*(this.output-this.input),m=a*this.velocity;this.amplitude=(o+m)/h,this.velocity+=this.amplitude*(this.delta/1e3),this.output+=this.velocity*(this.delta/1e3)});i(this,"animLoop",()=>{this.currentTime=Date.now(),this.animating||(this.lastTime=this.currentTime-1),this.delta=this.currentTime-this.lastTime,this.lastTime=this.currentTime,this.animating=!0,this.interpolate(),this.callback(this.output,this.velocity),this.animating=!(Math.abs(this.velocity)<.2&&Math.abs(this.output-this.input)<.2),this.animating?(cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(this.animLoop)):(this.animating=!1,this.onFinished(),console.log("finished spring animation"))});i(this,"animate",()=>{this.animating||this.animLoop()});this.animating=!1,this.callback=m,this.lastTime=0,this.currentTime=0,this.delta=0,this.animationFrame=0,this.stiffness=e,this.damping=a,this.mass=h,this.onFinished=l,this._input=o,this.output=this.input}set input(e){this._input=e,this.animate()}get input(){return this._input}}s.Springify=n,Object.defineProperties(s,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
